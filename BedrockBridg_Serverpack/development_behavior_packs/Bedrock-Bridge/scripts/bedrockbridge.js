function _0xeb96() {
    const _0x1c158a = ['CeeLU', 'jKiQk', 'MZfEa', 'TazIr', 'SpawnLocat', 'ables', 'auth', 'bKnIQ', 'variables', "before the", 'bjECd', 'NAWMP', 'zinbw', " not found", "ry to reco", "origin pro", 'dzTjr', "received r", 'lZgLg', 'lDJwM', 'QjMzN', 'qBWcD', "ns] error ", 'EnTjM', 'KWsCy', 'ygUJc', 'textField', "server con", 'DHOMG', 'max_attemp', " packet ", 'gmbTk', 'eVyjz', 'i:connect', 'eurFZ', 'EqplO', "mc look li", 'RgmbT', "figured. P", 'isOp', 'idge][Plug', "ists all c", 'join', " this)", 'olqDz', "§eIn order", "cache over", 'RwRrl', 'typeId', "<@&\\d+>", 'Wimip', 'wXUml', 'PAszJ', 'ykuIb', 'aaGPX', 'ser', 'address', 'tSVIi', 'request', '[tag=!espl', "e make sur", 'WhJKL', 'erDYk', 'bedrockCom', 'ynxUt', 'mOhQb', 'spNwG', "rver respo", 'XRUdG', 'ers', 'sGyGr', 'DzMyc', 'RzCFx', 'get', 'addTag', 'uHsqD', 'nsILL', " server", "rver found", "§eWe will ", 'ands.§r', 'ldRCX', 'VGwxw', "set to ", 'ellMv', "ation sett", 'MutedBB', 'yOTMg', 'esp:pfp', 'bYhbh', "og they wi", 'HzBwU', 'GvALY', "le connect", 'YmsFm', 'split', '(BedrockBr', 'ALmOX', 'defineProp', 'FaDcs', 'iJRPo', 'QPziH', "n/off]§r -", 'ZoEkV', "oin ban/un", "ce set to ", "parsing co", 'BannedBB', 'cfVLe', "resume sho", 'vIPlD', " been unmu", "§eYour pro", 'hqUQF', 'sJTdH', 'offline', "ided token", 'wVavu', 'gCommand', 'catch', 'udTYp', 'YSfdW', "login erro", "is addon.", 'sZXmU', "nnect by §", " started.", 'ettings.§r', 'EsDpR', 'discordCom', 'yVfhC', " was renam", 'currentVal', 'cNixu', 'ime', 'getNearbyP', 'location', 'tqmIa', 'SBRYS', 'jJCBc', '@discord_u', "ne instanc", 'FtDTn', 'map', 'etLoH', 'CBAUC', 'Rdmyn', 'round', 'stringify', 'tify', 'qUilH', 'NnhRM', "first logi", 'playerDieL', 'FJFlT', 'KdQCU', 'LMUfF', 'beforeEven', "\n§oYou are", 'i:origin', 'TODum', 'UserClosed', 'worldStart', "tus of the", 'IEDYq', 'PjEAZ', 'RXZhw', 'dboVG', 'Qodqh', 'output', 'sOkDv', " discord. ", 'AqIgr', "n your scr", 'AhIsH', 'TICK_MAX', 'gameMode', 'hjsfz', 'LJUED', "g player", 'aWViY', 'YYPeA', 'tags', 'OHLac', 'ets', 'rawtext', "ed due to ", 'btfbl', 'e-setup.', 'Igzoa', "nd is disa", " to use th", "§\\l.+?§r", "imply run ", "e.g. !", 'tiznx', 'Object.', 'cancel', "re and nam", 'readBase64', 'sMvuu', 'zszoF', "plete setu", 'yKSJr', 'ADHGM', "kick ", 'utKlm', 'BuSLy', "logging [o", "t token.", 'from', 'nNeNb', 'Twjlk', 'message', 'THjYE', "er.\n", 'taBTL', 'Zqzpl', 'CPQHq', 'wrNpB', 'fgwTB', 'jmais', 'FqPHe', 'Yixyi', 'qEuBZ', "rror: can'", 'zLZWq', " being vis", "he full li", 'jFbdN', 'NPJcd', "failed req", 'playerCoun', 'gBijt', 'tGgFC', 'readNumber', 'getSetting', 'diKqd', 'readBoolea', 'QAGKZ', 'legacy', 'runCommand', 'KIsIn', 'sdFeE', 'subscribe', 'AmgUt', 'MJDUK', 'QmivH', 'floor', 'LNOLp', 'ipWtD', 'KMbhX', 'sWRMl', 'TPZPh', 'fGxjq', 'CXCAV', 'VYfib', 'VchYD', 'vBwyz', 'HnBoe', 'jMHRO', 'wmPPq', 'ext', 'mezHX', 'DSpso', 'IBEkb', 'tFzoT', 'urqkR', 'nameTag', 'Entity', "undeaf§r -", 'sender', 'OXlVQ', '#discord_c', '§9<', 'dimension', 'y.dreamsmp', 'yTPye', 'fAbHL', 'VSXEi', 'bcdjA', "config\" fo", 'successCou', 'oOQHv', "oles packe", 'user', " token is ", 'amount', 'getTags', "too short.", "in] Custom", 'tFWWf', 'getSpawnPo', 'vbeIO', 'aZUAv', 'text', 'pWcqA', 'OhKaN', 'FxfRL', 'PkXIv', 'ready', 'dropdown', 'UuAuh', "- Error ", 'afterEvent', 'player', "server alr", 'HTrgD', 'BRquV', "lease run ", "§ediscord ", 'BlJqi', 'callback', '>:(', 'dwSrw', "iscord).\n", 'iibaO', 'gFFJz', 'klXWV', 'author', 'CEZNP', 'uwHZN', 'error', "proximity ", "t allowed ", 'uVmWJ', 'pSxAw', 'parseInt', " was kille", 'ivcnX', '...', "en you rel", 'length', 'bled', "his server", 'SIBPG', 'MljCi', 'cWVxN', 'zMPzi', 'rMFCL', 'eQgPL', 'NMKMw', 'pWHnu', "nd customi", 'chxCS', 'Fmdoy', 'ings', "§eAll vali", 'qRfpH', 'ixkSz', "ualised on", 'lOXcy', 'dQiMt', "tellraw @a", 'oeOGB', 'ZFGiB', 'charAt', 'getCompone', 'rgjyf', "ing to the", 'Post', 'PHJVT', "son\". Plea", "g.\n", 'pVRtF', "scord mess", "ut if the ", 'gUyJg', 'layers', 'clear', 'level', 'rjdUd', 'CYmnT', 'YyNHQ', "t deafen.", 'setToken', 'inventory', 'kXQaT', 'oratori:se', 'jmbpN', 'CTogo', "er for fil", "d by ", 'WyhMn', 'HQBle', 'HFAPv', 'XhYnD', 'kKBgT', "you killed", 'vqvsJ', 'timeout', 'qUQGn', "ridge] Cou", 'headers', "en.\n", 'wNVfj', 'huDuj', 'localhost:', " died by ", 'pZEfo', 'set', 'HTKgH', 'ABCDEFGHIJ', "ridge] Mis", "e searchin", 'runTimeout', 'displayNam', "e of this ", " found onl", 'ping', 'VXBRN', 'JvWtk', 'NZHeA', 'test', 'IgJcx', 'DGnKj', "Please com", 'skSUR', 'com', "\nList of a", 'kHKZO', 'bwChO', 'PGyJX', 'drockBridg', 'setup', 'esplorator', 'QUzip', 'cJcSJ', "operly set", 'AEASE', 'qyHbd', 'chatDownSt', 'dTmyp', 'logging', 'wMOXC', 'messages', 'nected.', "st of comm", 'eEhhg', 'VijVk', 'GLYTs', 'value', "se Bedrock", 'pDXWW', 'min_timeou', "etup pleas", " the serve", " Run ", 'getTick', "on this se", "es from di", 'sygkt', 'VBYNI', 'Property', 'YqYZv', 'qIcdP', "dge connec", 'MuNyL', 'sendMessag', 'events', 'edrockBrid', "he first t", 'zFyen', "m minecraf", "ord server", 'eQabe', 'getItem', 'FJeBN', 'esp:join_t', "ll be set ", 'OOZkb', 'yRBlx', "Cannot cre", "fig folder", 'HdoJi', "sing disco", 'rror', "ror loggin", '89-_', 'FcKiA', 'FgQvY', 'AgLvu', 'nventory.', "ommands fo", "setup, or ", "w token fr", 'UdRMn', 'uWjBy', 'CrNQh', 'hannel', 'YHPJZ', " to switch", 'les', 'OqQgA', 'YmCIt', 'cByUV', 'aLXHU', 'brumh', " saved.", "ridge addo", 'ClpMb', 'values', "llowing to", 'addHeader', "claimdc us", "get invent", "'t be long", 'IhlZO', 'WlUYp', 'txt', 'CIbKu', 'TsibJ', "It wasn't ", 'HccGn', 'qTbiP', 'msAKF', 'mands', 'tuXSo', 'uest', "while impo", 'opqrstuvwx', '/scripteve', "box accoun", 'UUgfD', " streamed ", "t (require", 'hasTag', "this comma", 'emit', 'efghijklmn', 'flatMap', 'AuHdR', " your appe", 'up.', 'jqMVa', 'NwkQk', 'ZbSaW', 'xGIQQ', 'eLog', "<@\\d+>", 'replace', 'BOVfi', 'MnwMC', 'khRcw', 'minecraft:', 'NRLiS', 'sourceEnti', 'compact', 'ihovG', "etreiving ", 'LXvww', 'qbaaz', 'playerSpaw', "mple §opla", 'GEhrP', 'jSBPh', 'nnXUC', "addition e", 'i.space:60', 'JMSmF', 'NFDUT', 'getScore', "file pictu", "d from the", "e.g. play.", "help for t", 'omnxn', 'ysZuj', 'YMxyH', 'terminateR', 'sourceType', 'pbOWy', 'hqYUo', "te ingame-", 'prefix', 'ihjrI', 'BYhhZ', 'SiKIV', "e you adde", 'SOXJV', 'FQuix', 'connect', " currently", 'imIJG', 'CxlZN', 'linkdc', 'login', 'getAllPlay', 'dgFRG', 'unmute', 'JFFbV', "already de", "d token.\n\n", " online.", 'sbXbh', 'PdSoK', '§cdiscord-', 'efixedAll', 'LUAIg', 'AgseS', " server.\n", "to default", 'AxcQI', "idge] prov", " banned fr", 'toggle', 'ZnvhM', "erminate r", 'mydomain.g', 'nwTaO', 'title', "er by runn", "help§r - l", 'MUMKV', "tput mode", 'uPFel', "new distan", 'wOZdy', 'SnjyK', " have been", 'MytGL', 'TRivG', 'kWtcM', "§eerror lo", 'uAGkn', "already no", 'WBzbo', 'LgSCw', 'PBEts', 'WoPBd', 'oPsVb', 'nKYxL', 'Content-Ty', " and resta", 'EAGTl', 'wlxEM', "e ingame s", 'puVKp', 'proximity_', 'filter', 'SudSP', "e configur", 'UrTqN', 'initialSpa', "ge's files", 'kill', 'oyoOh', 'origin', 'RFRnY', 'gDc', 'n/json', 'i:status', "ine.\n*Note", "ort. Pleas", 'UFvmT', "ned from t", " issues. T", 'cKdgL', 'ZzUeo', 'KOrGY', 'KwKoY', 'random', 'ialize', 'reverse', 'qtWxf', 'BVeXB', 'CjVIw', 'messages§r', "ore than o", 'sUOrw', 'eDbRq', 'muted', "e emitting", 'log', "lder is pr", 'oJLvC', 'hasPartici', 'includes', 'pqIMW', 'bYWPj', 'OhxvL', "rror\n", 'overworld', 'EtmAd', 'scord-mess', 'hjvwQ', 'age', 'jAaeT', 'i:self_dea', "prefix can", 'MsKRM', 'lzTlt', 'dyLJl', 'oRAgC', 'bzTHA', 'fPkkp', 'match', 'ves', 'AbnfS', 'MgcIs', 'gLVZn', 'KoKLF', 'KLMNOPQRST', "dge - Sett", 'kQVEh', 'getPrefixe', 'ReferenceE', 'wUfUr', 'i:discord_', 'iVicg', "is not con", 'YsWSg', 'NvCxH', 'NHNJa', "vailable c", "etag for c", 'zKSty', 'ospaF', 'chatComman', "ins.\n", "urrent sta", 'VlyUm', 'tional]', 'aZPFt', 'push', 'tNMSw', " enable er", "You can re", 'CRWFI', 'aapph', "in. bad se", "§cno messa", 'Pylkv', 'yzjVw', 'mmand', 'HqYUK', 'playerLeav', 'ETvoo', 'HUuzG', 'iDmEC', 'jfgOz', 'OpVFP', 'method', 'eTHmy', 'kRcxA', 'RiqED', 'GORET', 'getDynamic', 'kTXGP', 'iOsMW', 'RVhbK', 'yLtma', 'BRZNm', 'LduAQ', "een.\n", "t without ", 'rver', "Origin [op", 'VHBNG', 'wSVgu', "Bridge. If", 'erty', 'Jqlxw', 'SUwYy', 'gceUU', " will be a", 'jkpsy', 'wDXMg', " was muted", 'jCBXR', 'tMCpI', 'True', 'EXxMM', 'Onbok', 'ebWJp', 'DpLeX', "an setup a", "idge] Bedr", 'NCjIU', 'IycAe', 'ZNqNM', "player's s", "t create m", 'mAcmH', 'Get', 'allow_mode', 'SKXGW', 'zGDnR', 'ojrVy', 'VEkYb', 'BqDBm', 'gxJCg', 'getObjecti', "idge) conn", "idge) Impo", 'unbanned', 'damagingEn', 'DANxU', 'uioLX', 'lCzeo', "ages (on d", 'sipul', " resume di", 'includesPr', "top messag", " was banne", 'tification', "you are no", 'cache_mess', "lf_deaf] ", 'fhcxX', 'oKAhL', 'vXkkc', 'tity', 'RwPWh', 'additions', 'pDLmx', 'epzxE', "n order to", " this is t", 'toString', 'link', "ockBridge ", 'siFJK', 'YmGGt', 'names', 'VblFv', 'EMwSO', 'Ssmve', 'SqdVS', 'discord_li', 'ServerVari', 'fFqZw', 'EhVdO', "error whil", 'yiwiJ', "u have alr", "ed to ", 'WqBHb', "ken as arg", 'pFdUB', 'chatUpStre', 'tRGBS', 'pBrce', 'kBggR', " - list er", "sages from", " event:\n", 'enabled', 'bpOyK', 'oiCNg', 'trim', 'efix', 'UVWXYZabcd', 'buztT', "link is no", 'YSWox', "rd token. ", " it in the", "se wait.§r", "§cYou are ", 'YiTfK', 'OyNiN', 'cfzBq', 'connecting', 'setBody', 'sCvVo', 'ion', 'rver.§r', 'allow', 'online', 'watchdogTe', 'YBSvx', " server. R", 'HxIfn', 'vyErw', 'readIntege', 'hwsfK', "Command pr", 'Identity', 'SAaeB', './bridgePl', 'OZloy', '§cProvided', "scord serv", 'unsubscrib', 'sizing', 'toBedrock', 'cted.§r', 'http://', 'getDimensi', 'pvgEQ', 'MPlQy', 'cCbEX', 'TiXGD', "er than on", 'PaioK', " limit: re", "re that \"/", 'dYntB', 'HBFVH', 'DZyih', 'yaPwE', 'dSLmw', "un ", 'wYoAZ', 'cBVOB', 'hCNbI', 'WkncC', 'SlEuc', " make your", "player's i", "p in order", 'XHtMs', "use the /c", 'ecting...', 'VtuMM', 'rXdyR', 'i:startup_', 'setTimeout', 'ptJQQ', 'Igpwj', 'gHBOJ', "Player not", "e this add", 'YdTVv', 'kcboc', "dded to te", " reset. Wh", "restarted ", 'XNHSM', 'rMgLQ', " already c", "§cYou cann", 'gJTaU', "§cdiscord ", 'fdbBZ', 'scoreboard', 'Log', 'jZSSa', "tyle go to", 'UeiVO', " past you ", 'ihZFa', "vided: exa", 'czyix', "k error", 'add', 'KTACT', " token in ", 'yUyqV', 'nReason', 'ream', 'authtoken', 'EJmVB', 'GDaNj', 'hasCommand', "rting plug", "§cInvalid ", 'version', 'datEb', 'RBiAY', "§\\o.+", "re to add ", 'isValid', 'pQvHA', 'siXqU', 'pant', 'formValues', 'playerDeat', 'HApSI', 'deadEntity', 'LgOnm', 'status', " is too sh", 'JXBzZ', 'true', "y try to j", 'GReFt', 'KHVZP', 'ingame', 'MOuNG', "s relog).\n", 'nxoQN', 'dEoeZ', 'dWQGx', "§r - ", "ing §o/new", "ng you mes", 'forEach', 'wpVSF', 'playerJoin', 'pTDQh', 'ByoWS', " was unmut", 'descriptio', 'playerName', "possible r", "ge from se", "messages i", 'SNNjP', 'DvLva', "§oYou have", 'nBLbO', 'dcNametag', 'PAuPB', 'bridgeInit', 'prototype', 'IIksh', 'erties', 'pfp', 'OiSVK', "t-style to", 'QuJal', 'dmtKN', 'entityDie', 'now', "get stats ", 'BVjnt', "ot open Be", 'IbgSz', 'startsWith', 'discord_ro', " picture a", 'show', 'CngBU', 'NtNVS', 'nsedy', 'goVOX', 'Gomuk', "Discord to", 'dge][Plugi', 'zCYRE', "ate more t", "nt esplora", 'ted.', 'XRpRD', "this class", 'lCLSj', 'pKfsz', 'YZznP', 'fxYrd', 'tats.', "ommands:\n", 'EGMRm', 'list', 'eaxNu', 'ShskU', "n error", "on make su", 'dKGwD', " and run /", 'tNGvl', "\\*.+\\*", 'ument:', "-token§r.\n", 'body', 'wWMDD', 'tjiZD', 'LIiNl', 'IkYNn', 'YNGza', 'HbdaO', 'fiMYi', 'warn', "arance fro", 'TyUfD', 'XOlEy', 'slice', 'kxyXZ', 'setDynamic', "d settings", '1.3.10-alpha', "gging disa", 'YuSll', 'KEafo', 'YzbMJ', 'post', 'khFoQ', 'ZESZs', "d the righ", 'ICEDS', 'DEnyu', 'uQVRS', '8=X', 'Async', 'damageSour', "§oe.g. 69B", 'bEtmX', 'siSmF', 'toDiscord', 'errored', 'stXrU', 'dbHqk', 'WjuIK', "cache chec", 'HEnlE', 'yLKsb', 'IpasA', "status - c", 'code', 'afened.', "- connect ", 'iAMLb', "ing them s", 'MGLad', 'KbFwu', 'eAyua', 'lagZr', "r streamed", 'wZFaW', "Startup no", 'bDQlL', "dge v", 'secrets', 'xykHB', 'registerTa', " using fil", "§cCommand ", "gin error ", 'isAllowed', "eady added", 'iJZoy', 'ZHpZR', "the discor", 'ZQvWC', 'GPpOU', 'xhXLP', 'reload', 'rminate', "If you wan", " check err", "om this se", 'minCommand', 'has', 'CTfVG', 'PtvDS', " from /con", 'concat', 'Gmmxb', 'GSRaE', 'eLFjj', 'ilVyb', "t to resum", 'NKofe', '.§r', 'i:admin', "Discord li", 'EQdfx', 'vgbqO', 'distance', 'ilErK', 'NcKMS', 'IczKb', 'is_tamed', 'QymPI', "rder to us", 'ZMfFl', 'fxIKw', 'CMcdp', 'gZBbP', 'pTtRi', 'NyzDl', '[BedrockBr', 'token', 'OXfio', 'removeTag', 'spwRf', "failed log", 'readPlayer', 'parse', 'OCWEJ', 'defaultVal', 'i:output', 'RNVnP', 'bDlcs', 'eAll', 'OySkT', "is in cool", 'pbCKU', "§\\l.+", "e remove B", 'JPBXQ', 'etVPf', 'getPlayers', 'sxfrj', 'OfFNJ', 'run', 'nBHRK', 'uKQfJ', "e characte", 'registerCo', 'undeaf.', 'bridge-plu', 'FqnIh', 'FzgpP', 'health', "eady conne", "\"secrets.j", 'vwKwF', "t error", 'false', 'CCtGT', 'XInXc', 'cause', 'string', 'KTOLO', 'iNWPE', 'VeDBr', " register ", 'EYzrC', 'starting', 'led§r', 'FXgUP', "onse objec", 'mQkzG', 'UnfuE', 'Kymbq', "e visualis", "se make su", "age show o", "dge discon", "Here you c", 'FOWyd', "status: ", 'ZQbJC', 'mVGSq', "ldn't find", 'xlkGa', 'FtGAe', 'Azezz', " no such c", 'off', 'ExpVF', 'Fxwnj', 'oBmVI', 'bsGmh', 'PPGPM', 'i:authtoke', 'BedrockBri', 'UKnFA', 'ole', 'nected!§r', 'extra_prop', "§cThere is", "server is ", "down, plea", 'HwZEe', 'tori:setup', '@discord_r', 'TxuYN', 'playerId', 'default', 'BFlEO', 'i:prefix', '[BedrckBri', 'DZCyN', 'nIHqY', 'pOyup', 'name', 'BsEzs', 'gSQgT', 'GUEth', 'tdciv', '.gg', 'saIUC', 'Lkgsd', 'EezNU', 'esp:nameTa', 'HvPGA', "necting to", 'startup_no', 'request.', 'wpxuS', 'HKHSE', 'help', 'then', 'cancelatio', "nd as it's", 'qCJLM', 'GyIaC', 'leMjQ', 'ArVpq', 'NpMBf', 'indexOf', " §lyou hav", 'FOnvb', 'ZuTSF', 'uugBM', "can ignore", 'CkSii', 'PmNtE', 'ovFXe', " packet", 'tCqQu', 'sBSmK', 'ZSoQD', 'GDcGz', 'EqIpj'];
    _0xeb96 = function() {
        return _0x1c158a;
    };
    return _0xeb96();
}
import {
    system,
    world,
    GameMode,
    Player,
    ScriptEventSource
}
from '@minecraft/server';
import {
    HttpRequest,
    HttpRequestMethod,
    http,
    HttpHeader
}
from '@minecraft/server-net';
import {
    FormCancelationReason,
    ModalFormData
}
from '@minecraft/server-ui';
import * as _0x1d1291 from '@minecraft/server-admin';
import {
    bridgeEvents,
    bridge,
    commandArgument
}
from './definitions';
const translate = ["starting", "online", 'sleeping', "offline", "errored"];
const overworld = world.getDimension("overworld");

function _0x2aadc9(_0x3ae5a3, _0x5dfa02, _0xb0e25c, _0x229732) {
    return _0x3eff(_0x3ae5a3 + 0x2fb, _0xb0e25c);
}
console.log("BedrockBridge v1.3.10-alpha started.");
world.sendMessageAll = world.sendMessage;
world.sendMessage = _0xe3964c => {
    const _0x576d00 = {
        text: _0xe3964c
    };
    const _0x58cd7f = {
        rawtext: [_0x576d00]
    };
    overworld.runCommandAsync("tellraw @a[tag=!esploratori:self_deaf] " + JSON.stringify(_0x58cd7f));
};
class bridgeEvent {
    constructor(_0x3b4092) {
            this.name = _0x3b4092;
        }
        ["subscribe"](_0x11ec0d) {
            this.#callbacks.set(_0x11ec0d, _0x11ec0d);
            return _0x11ec0d;
        }
        ["unsubscribe"](_0x8c1e94) {
            this.#callbacks['delete'](_0x8c1e94);
        }
    async ["emit"](_0x1a2348, ..._0x773d3) {
        const _0x5ef90c = {
            'HsvQw': function(_0x1b03a0, _0x1c2c63) {
                return _0x1b03a0 + _0x1c2c63;
            },
            'dQiMt': "error",
            'IbgSz': function(_0x1b9b21, _0x1a9c0c) {
                return _0x1b9b21 === _0x1a9c0c;
            },
            'mgpZo': "string",
            'KTACT': function(_0x40a76e, _0x41f698) {
                return _0x40a76e >= _0x41f698;
            },
            'BbQJc': function(_0x222222, _0x50bf90) {
                return _0x222222 <= _0x50bf90;
            },
            'yLKsb': function(_0x258c00, _0x226fb4) {
                return _0x258c00 !== _0x226fb4;
            },
            'Azezz': "oeOGB",
            'KdQCU': "dWQGx",
            'iibaO': function(_0x89c945, _0x56606a, ..._0x162fd0) {
                return _0x89c945(_0x56606a, ..._0x162fd0);
            }
        };
        for (const _0x20ff0a of this.#callbacks.values()) {
            try {
                await _0x5ef90c.iibaO(_0x20ff0a, _0x1a2348, ..._0x773d3);
            }
            catch (_0xe62e73) {
                console.error("bridge-plugin error for " + this.name + " event:\n" + _0xe62e73);
            }
        }
        return _0x1a2348;
    }
    #callbacks = new Map();
}
commandArgument.prototype.readNumber = function() {
    return Number.parseFloat(this);
};
commandArgument.prototype.readInteger = function() {
    return Number.parseInt(this);
};
commandArgument.prototype.readBoolean = function() {
    if (this == "true" || this == "True" || this.value == 1) {
        return true;
    }
    else {
        if (this.value == "false" || this.value == 'False' || this.value == 0) {
            return false;
        }
    }
};
commandArgument.prototype.readPlayer = function() {
    return world.getPlayers({
        'name': this.toString()
    })[0];
};
commandArgument.prototype.readLocation = function() {
    const [_0x1e252e, _0x4f0d1b, _0x346096] = this.split(" ").map(_0x2ecb39 => Number.parseInt(_0x2ecb39));
    return new Vector(_0x1e252e, _0x4f0d1b, _0x346096);
};
class bedrockCommandManager {
    ["registerCommand"](_0x28f802, _0x3f2017, _0x20a08b, ..._0x5c426b) {
        const _0x344dae = {
            callback: _0x3f2017
        };
        _0x344dae.description = _0x20a08b;
        _0x344dae.tags = _0x5c426b;
        if (this.#callbacks.has(_0x28f802)) {
            throw "You cannot register this command as it's already registered.";
        }
        else {
            this.#callbacks.set(_0x28f802, _0x344dae);
        }
    }
    ["registerAdminCommand"] = (_0x3abfeb, _0x385f10, _0x3e4fe6) => this.registerCommand(_0x3abfeb, _0x385f10, _0x3e4fe6, "esploratori:admin");
    ["registerTagCommand"] = this.registerCommand;
    ["hasCommand"](_0x152756) {
        return this.#callbacks.has(_0x152756);
    }
    async ["runCommand"](_0x48e81c, _0x416783, ..._0x211a96) {
            const _0x5c2b79 = {
                aapph: function(_0xa389c3, _0x5d2671) {
                    return _0xa389c3 + _0x5d2671;
                }
            };
            _0x5c2b79.wlxEM = "§r - ";
            _0x5c2b79.uAGkn = function(_0x572234, _0x532f36) {
                return _0x572234 !== _0x532f36;
            };
            _0x5c2b79.OyNiN = "Gomuk";
            _0x5c2b79.HzBwU = function(_0x3146e4, _0x1fce1e) {
                return _0x3146e4 + _0x1fce1e;
            };
            _0x5c2b79.PAszJ = "[BedrockBridge][Plugin] Custom command error\n";
            if (this.#callbacks.has(_0x48e81c)) {
                if (_0x5c2b79.uAGkn("Gomuk", _0x5c2b79.OyNiN)) {
                    _0x23d019 += '§o' + this.prefix + _0x4323bb + _0x5c2b79.wlxEM + _0x532c4d + "\n";
                }
                else {
                    try {
                        await this.#callbacks.get(_0x48e81c).callback(_0x416783, ..._0x211a96);
                        return true;
                    }
                    catch (_0x3a04e3) {
                        console.error(_0x5c2b79.HzBwU(_0x5c2b79.PAszJ, _0x3a04e3));
                        return false;
                    }
                }
            }
        }
        ['isAllowed'](_0x510725, _0x420e2a) {
            if (this.#callbacks.has(_0x510725)) {
                if (this.#callbacks.get(_0x510725).tags.length == 0) {
                    return true;
                }
                for (const _0x1650ce of this.#callbacks.get(_0x510725).tags) {
                    if (_0x420e2a.hasTag(_0x1650ce)) {
                        return true;
                    }
                }
            }
            return false;
        }
        ['forEach'](_0x2c3b9b) {
            this.#callbacks.forEach((_0x2a0d36, _0x4f69d9) => {
                _0x2c3b9b(_0x4f69d9, _0x2a0d36.callback, _0x2a0d36.description, _0x2a0d36.tags);
            });
        }
    #callbacks = new Map();
}
class bridgeCommandManager {
    #command_list = [];
    #allow = false;
    get["allow_mode"]() {
            return this.#allow;
        }
        ["isAllowed"](_0x9cdf6e) {
            return this.#command_list.includes(_0x9cdf6e) && this.#allow || !this.#command_list.includes(_0x9cdf6e) && !this.#allow;
        }
        ['forbid'](_0x31c7fe, ..._0x2ffe07) {
            if (this.#allow) {
                this.#command_list = [_0x31c7fe, ..._0x2ffe07];
                this.#allow = false;
            }
            else {
                this.#command_list.push(_0x31c7fe, ..._0x2ffe07);
            }
        }
        ["allow"](_0x2c2a38, ..._0x42a352) {
            if (this.#allow) {
                this.#command_list.push(_0x2c2a38, ..._0x42a352);
            }
            else {
                this.#command_list = [_0x2c2a38, ..._0x42a352];
                this.#allow = true;
            }
        }
    get["list"]() {
        return [...this.#command_list];
    }
}
bridge.bedrockCommands = new bedrockCommandManager();
bridge.discordCommands = new bridgeCommandManager();
bridge.events = new bridgeEvents();
bridge.events.bridgeInitialize = new bridgeEvent("bridgeInitialize");
bridge.events.chatUpStream = new bridgeEvent("chatUpStream");
bridge.events.chatDownStream = new bridgeEvent("chatDownStream");
bridge.events.playerJoinLog = new bridgeEvent("playerJoinLog");
bridge.events.playerLeaveLog = new bridgeEvent("playerLeaveLog");
bridge.events.playerDieLog = new bridgeEvent("playerDieLog");
bridge.events.petDieLog = new bridgeEvent('petDieLog');
bridge.events.chatCommand = new bridgeEvent("chatCommand");
bridge.events.error = new bridgeEvent("error");
const _0x29859b = {
    '😄': ':D',
    '😐': ':|',
    '😔': ':(',
    '😬': ':E',
    '😬': ">:(",
    '💀': "8=X"
};
String.prototype.toBedrock = function() {
    const _0x4bf005 = {
        gFFJz: "output"
    };
    _0x4bf005.zszoF = function(_0x46d683, _0x4fc54c) {
        return _0x46d683 !== _0x4fc54c;
    };
    _0x4bf005.PBEts = "\\*\\*.+\\*\\*";
    _0x4bf005.KoKLF = function(_0x423414, _0x1cec2d) {
        return _0x423414 + _0x1cec2d;
    };
    _0x4bf005.NRLiS = function(_0x1425f9, _0x3d1a77) {
        return _0x1425f9 + _0x3d1a77;
    };
    _0x4bf005.mOhQb = function(_0x4bedd3, _0x2b9ec7) {
        return _0x4bedd3 !== _0x2b9ec7;
    };
    _0x4bf005.PjEAZ = "uWjBy";
    _0x4bf005.ClpMb = "@discord_user";
    _0x4bf005.zPQHv = "<#\\d+>";
    _0x4bf005.skSUR = "#discord_channel";
    _0x4bf005.oRAgC = "<@&\\d+>";
    _0x4bf005.LNOLp = "@discord_role";
    _0x4bf005.dEoeZ = "UUgfD";
    let _0xbb66ae = this;
    for (const _0x2417de of _0xbb66ae.match(new RegExp(_0x4bf005.PBEts, 'g')) ?? []) {
        _0xbb66ae = _0xbb66ae.replace(_0x2417de, _0x4bf005.KoKLF(_0x4bf005.NRLiS('§l', _0x2417de.slice(2, -2)), '§r'));
    }
    for (const _0x3b8b77 of _0xbb66ae.match(new RegExp("\\*.+\\*", 'g')) ?? []) {
        _0xbb66ae = _0xbb66ae.replace(_0x3b8b77, _0x4bf005.NRLiS(_0x4bf005.KoKLF('§o', _0x3b8b77.slice(1, -1)), '§r'));
    }
    for (const _0x129031 of _0xbb66ae.match(new RegExp("<@\\d+>", 'g')) ?? []) {
        if (_0x4bf005.mOhQb(_0x4bf005.PjEAZ, _0x4bf005.PjEAZ)) {
            this.set("output", 0);
        }
        else {
            _0xbb66ae = _0xbb66ae.replace(_0x129031, _0x4bf005.ClpMb);
        }
    }
    for (const _0x149d72 of _0xbb66ae.match(new RegExp(_0x4bf005.zPQHv, 'g')) ?? []) {
        _0xbb66ae = _0xbb66ae.replace(_0x149d72, _0x4bf005.skSUR);
    }
    for (const _0x82ec4f of _0xbb66ae.match(new RegExp(_0x4bf005.oRAgC, 'g')) ?? []) {
        _0xbb66ae = _0xbb66ae.replace(_0x82ec4f, _0x4bf005.LNOLp);
    }
    for (const _0x17b07f in _0x29859b) {
        if (_0x4bf005.dEoeZ !== _0x4bf005.dEoeZ) {
            try {
                const _0x183be9 = _0x172e44.getDynamicProperty("esploratori:" + _0x1d0abf);
                if (_0x4bf005.zszoF(_0x183be9, _0x25acbd)) {
                    this.set(_0x22a506, _0x183be9);
                }
            }
            catch (_0x19d9c7) {}
        }
        else {
            _0xbb66ae = _0xbb66ae.replace(_0x17b07f, _0x29859b[_0x17b07f]);
        }
    }
    return _0xbb66ae;
};
String.prototype.toDiscord = function() {
    let _0x424e3c = this;
    for (const _0x3a3ab3 of _0x424e3c.match(new RegExp("§\\o.+?§r", 'g')) ?? []) {
        _0x424e3c = _0x424e3c.replace(_0x3a3ab3, '*' + _0x3a3ab3.slice(2, -2) + '*§r');
    }
    for (const _0x42114b of _0x424e3c.match(new RegExp("§\\l.+?§r", 'g')) ?? []) {
        _0x424e3c = _0x424e3c.replace(_0x42114b, '**' + _0x42114b.slice(2, -2) + '**§r');
    }
    for (const _0x2ebc54 of _0x424e3c.match(new RegExp("§\\l.+", 'g')) ?? []) {
        _0x424e3c = _0x424e3c.replace(_0x2ebc54, '**' + _0x2ebc54.slice(2) + '**');
    }
    for (const _0x58fc01 of _0x424e3c.match(new RegExp("§\\o.+", 'g')) ?? []) {
        _0x424e3c = _0x424e3c.replace(_0x58fc01, '*' + _0x58fc01.slice(2) + '*');
    }
    return _0x424e3c.replaceAll(new RegExp("§\\w", 'g'), '');
};
Player.prototype.mute = function() {
    this.addTag('MutedBB');
};
Object.defineProperty(Player.prototype, "muted", {
    'get': function() {
        return this.hasTag("MutedBB");
    }
});
Object.defineProperty(Player.prototype, 'deaf', {
    'get': function() {
        return this.hasTag("esploratori:self_deaf");
    }
});
Player.prototype.unmute = function() {
    if (this.hasTag("MutedBB")) {
        this.removeTag("MutedBB");
    }
};
const properties = {};
world.extra_properties = properties;
Object.defineProperty(Player.prototype, "dcNametag", {
    'get': function() {
        return this.getDynamicProperty("esp:nameTagDc");
    }
});
Player.prototype.getNearbyPlayers = function(_0xe2046d) {
    return Array.from(world.getDimension(this.dimension.id).getPlayers({
        'location': this.location,
        'maxDistance': _0xe2046d
    }));
};

function checkString(_0x52eed0, _0x24c35f, _0x3ba340) {
    return typeof _0x52eed0 === "string" && _0x52eed0.length >= _0x24c35f && _0x52eed0.length <= _0x3ba340;
}
async function getPlayer(_0x582892) {
    const _0x234bdd = {
        name: _0x582892
    };
    for (const _0x268825 of world.getPlayers(_0x234bdd)) {
        return _0x268825;
    }
}
async function getInventory(_0x488c39) {
    const _0x58d112 = [];
    const {
        container: _0xe40f13,
        inventorySize: _0x1b4801
    } = _0x488c39.getComponent("inventory");
    for (let _0x49d593 = 0; _0x49d593 < _0x1b4801; _0x49d593++) {
        const _0x454c43 = _0xe40f13.getItem(_0x49d593);
        if (_0x454c43) {
            _0x58d112.push([_0x454c43.typeId.replace('minecraft:', ''), _0x454c43.amount, _0x454c43.nameTag]);
        }
    }
    return _0x58d112;
}
async function getGamemode(_0x343a36) {
    for (const _0x2915e7 in GameMode) {
        const _0x4a591b = {
            'gameMode': _0x2915e7
        };
        for (const _0x5494c7 of world.getPlayers(_0x4a591b)) {
            if (_0x5494c7.id === _0x343a36.id) {
                return _0x2915e7;
            }
        }
    }
}
async function translateLocation(_0x12588c, _0x566a8a, _0x4377be, _0x4c2d01) {
    return [Math.floor(_0x12588c), Math.floor(_0x566a8a), Math.floor(_0x4377be), _0x4c2d01.id.slice(10)];
}
async function getAllScoreboard(_0x44257c) {
    const _0x50fd6d = {
        iJZoy: function(_0xfb2061, _0x4e0d05) {
            return _0xfb2061 == _0x4e0d05;
        }
    };
    _0x50fd6d.brumh = "false";
    _0x50fd6d.oBmVI = 'False';
    _0x50fd6d.NHNJa = function(_0x420420, _0x13f5bf) {
        return _0x420420 == _0x13f5bf;
    };
    _0x50fd6d.zFyen = function(_0x53e027, _0x43562e) {
        return _0x53e027 !== _0x43562e;
    };
    _0x50fd6d.HnBoe = 'sMvuu';
    if (_0x44257c.scoreboardIdentity) {
        return world.scoreboard.getObjectives().filter(_0x3ef0ec => _0x3ef0ec.hasParticipant(_0x44257c.scoreboardIdentity)).map(_0x2f93c1 => [_0x2f93c1.displayName, _0x2f93c1.getScore(_0x44257c.scoreboardIdentity)]);
    }
    else {
        if (_0x50fd6d.zFyen(_0x50fd6d.HnBoe, "sMvuu")) {
            if (this == "true" || this == 'True' || this.value == 1) {
                return true;
            }
            else {
                if (this.value == _0x50fd6d.brumh || this.value == _0x50fd6d.oBmVI || _0x50fd6d.NHNJa(this.value, 0)) {
                    return false;
                }
            }
        }
        else {
            return [];
        }
    }
}

function _0x3eff(_0x351bd8, _0x3d2da7) {
    const _0x211812 = _0xeb96();
    _0x3eff = function(_0x185380, _0x1af24f) {
        _0x185380 = _0x185380 - 443;
        let _0x918c06 = _0x211812[_0x185380];
        return _0x918c06;
    };
    return _0x3eff(_0x351bd8, _0x3d2da7);
};
async function getStats(_0x143510) {
    const _0x59b274 = _0x143510.getSpawnPoint() ?? world.getDefaultSpawnLocation();
    const _0x1c14dd = _0x143510.getDynamicProperty("esp:join_time");
    const _0x4d3266 = _0x143510.getComponent("health");
    const _0x23682e = {
        'nameTag': _0x143510.nameTag,
        'id': _0x143510.id,
        'level': _0x143510.level,
        'location': await [Math.floor(_0x143510.location.x), Math.floor(_0x143510.location.y), Math.floor(_0x143510.location.z), _0x143510.dimension.id.slice(10)],
        'gamemode': await getGamemode(_0x143510),
        'health': Math.round(_0x4d3266.currentValue / _0x4d3266.defaultValue * 100),
        'op': _0x143510.isOp(),
        'spawn': await [Math.floor(_0x59b274.x), Math.floor(_0x59b274.y), Math.floor(_0x59b274.z), (_0x59b274.dimension ?? overworld).id.slice(10)],
        'joinDate': _0x1c14dd ? new Date(_0x1c14dd * 3600000).toDateString() : 'unknown',
        'tag': _0x143510.getTags(),
        'scoreboard': await getAllScoreboard(_0x143510),
        'url': _0x143510.getDynamicProperty("esp:pfp")
    };
    return Object.values(_0x23682e);
}
async function sleep(_0x1b50ec) {
    return new Promise(_0x26b28b => {
        system.runTimeout(_0x26b28b, _0x1b50ec);
    });
}

function new_req(_0x3d1387, _0x23fcea, _0x47e508 = "Post", _0x31edf0 = 5) {
    const _0x579505 = {
        'vBwyz': "Content-Type"
    };
    _0x579505.VSXEi = "application/json";
    _0x579505.fPkkp = "auth";
    const _0x197e7e = new HttpRequest(_0x3d1387);
    _0x197e7e.timeout = _0x31edf0;
    _0x197e7e.method = HttpRequestMethod[_0x47e508];
    _0x197e7e.headers = [new HttpHeader("Content-Type", _0x579505.VSXEi), new HttpHeader(_0x579505.fPkkp, _0x23fcea)];
    return _0x197e7e;
}
import './bridgePlugins/index';
class BedrockBridge {
    static #instantiated = false;
    constructor() {
        if (BedrockBridge.#instantiated) {
            throw "ReferenceError: can't create more than one instance of this Object.";
        }
        else {
            BedrockBridge.#instantiated = true;
        }
        this.prefix = settings.get('prefix') ?? '!';
        this.#serverEndpoint = settings.get("test") ? "localhost:60" : "esploratori.space:60";
        this.#n_online_players = world.getAllPlayers().length;
        this.#push(["log", ["worldStart", []]]);
        for (let _0x4b9a54 of world.getAllPlayers()) {
            this.#online_players[_0x4b9a54.name] = _0x4b9a54.getDynamicProperty("esp:pfp");
        }
        world.afterEvents.playerJoin.subscribe(_0x69695f => {
            this.#n_online_players += 1;
            if (this.#mode == 2) {
                this.#login();
            }
        });
        world.afterEvents.playerSpawn.subscribe(async _0x366c1f => {
            if (!_0x366c1f.initialSpawn) {
                return;
            }
            const _0xeee4b1 = _0x366c1f.player.getDynamicProperty("esp:pfp");
            if (!_0xeee4b1) {
                this.#push(["set", ["pfp", _0x366c1f.player.name]]);
            }
            else {
                this.#online_players[_0x366c1f.player.name] = _0xeee4b1;
            }
            if (this.#mode <= 2) {
                const _0x4d81ef = {
                    'user': _0x366c1f.player.name
                };
                const {
                    user: _0x1fcad9,
                    cancel: _0xb551e3
                } = await bridge.events.playerJoinLog.emit(_0x4d81ef, _0x366c1f.player).then(_0x2d5f21 => {
                    if (!(typeof _0x2d5f21.user === "string" && _0x2d5f21.user.length >= 1 && _0x2d5f21.user.length <= 50)) {
                        _0x2d5f21.user = _0x366c1f.player.name;
                    }
                    return _0x2d5f21;
                });
                this.#push(["set", ["playerCount", this.#n_online_players]]);
                if (!_0xb551e3) {
                    this.#push(["log", ["playerJoin", [_0x1fcad9, this.#n_online_players, _0xeee4b1]]]);
                }
            }
            if (!_0x366c1f.player.getDynamicProperty("esp:join_time")) {
                _0x366c1f.player.setDynamicProperty("esp:join_time", Math.floor(Date.now()) / 3600000);
            }
        });
        world.afterEvents.playerLeave.subscribe(async _0x40922a => {
            this.#n_online_players -= 1;
            const _0x412d52 = this.#online_players[_0x40922a.playerName];
            if (this.#mode <= 1) {
                this.#push(["set", ["playerCount", this.#n_online_players]]);
                const _0x11a7bc = {
                    user: _0x40922a.playerName
                };
                const _0x23fd28 = {
                    name: _0x40922a.playerName,
                    id: _0x40922a.playerId
                };
                const {
                    user: _0x2539db,
                    cancel: _0x21aac8
                } = await bridge.events.playerLeaveLog.emit(_0x11a7bc, _0x23fd28).then(_0x510295 => {
                    if (!(typeof _0x510295.user === "string" && _0x510295.user.length >= 1 && _0x510295.user.length <= 50)) {
                        _0x510295.user = _0x40922a.playerName;
                    }
                    return _0x510295;
                });
                if (!_0x21aac8) {
                    this.#push(["log", ["playerLeave", [_0x2539db, this.#n_online_players, _0x412d52]]]);
                }
            }
            delete this.#online_players[_0x40922a.playerName];
        });
        system.beforeEvents.watchdogTerminate.subscribe(_0x1645cf => {
            _0x1645cf.cancel = true;
            this.#error(23, "watchdog terminate reason: " + _0x1645cf.terminateReason);
        });
        this.#_delayed_constructor();
        const _0x42b3a6 = ["discord_roles"];
        this.additions = new Map();
        (async () => {
            await bridge.events.bridgeInitialize.emit({
                'registerAddition': (_0x44dd3f, ..._0x3eb08b) => {
                    if (_0x42b3a6.includes(_0x44dd3f) && !this.additions.has(_0x44dd3f)) {
                        this.additions.set(_0x44dd3f, _0x3eb08b);
                    }
                }
            });
            if (this.additions.has("discord_roles")) {
                this.additions.set("discord_roles");
                const _0x1b0099 = {
                    discord_roles: true
                };
                this.#push(["set", ["add", _0x1b0099]]);
            }
            if (settings.ready) {
                await this.#login().then(_0x6e5608 => {
                    this.#cycle();
                }, this.#error(12, "first login error"));
            }
            else {
                this.#mode = 3;
                console.warn("[BedrockBridge] BedrockBridge is not configured. Please run /scriptevent esploratori:setup to complete ingame-setup, or use the /config folder for file-setup.");
                this.#cycle();
            }
        })();
    }
    async #_delayed_constructor() {
        system.afterEvents.scriptEventReceive.subscribe(_0x298fee => {
            switch (_0x298fee.id) {
                case "esploratori:setup": {
                    if (_0x298fee.sourceEntity instanceof Player) {
                        if (!settings.ingame) {
                            _0x298fee.sourceEntity.sendMessage("§cYou cannot open BedrockBridge ingame settings.§r\n§oYou are currently using file configuration settings. In order to use ingame setup please remove BedrockBridge's files from /config folder and restart the server.");
                            return;
                        }
                        const _0x3d6ec7 = _0x298fee.sourceEntity;
                        system.run(async () => {
                            var _0x3871ae = await MainBridgeMenuForm.show(_0x3d6ec7);
                            while (_0x3871ae.canceled) {
                                if (_0x3871ae.cancelationReason == FormCancelationReason.UserClosed) {
                                    return;
                                }
                                await sleep(5);
                                _0x3871ae = await MainBridgeMenuForm.show(_0x3d6ec7);
                            }
                            const [_0x35d423, _0x1d4035, _0x571606, _0x5b6b65, _0x586bfa, _0x1726ed] = _0x3871ae.formValues;
                            if (_0x35d423.length == 1) {
                                this.prefix = _0x35d423;
                                world.setDynamicProperty("esploratori:prefix", _0x35d423);
                            }
                            else if (_0x35d423.length > 1) {
                                _0x3d6ec7.sendMessage("§cCommand prefix can't be longer than one character.");
                            }
                            if (_0x1d4035.length > 5) {
                                settings.setToken(_0x1d4035);
                            }
                            else if (_0x1d4035.length > 0) {
                                _0x3d6ec7.sendMessage("§cProvided token is too short.");
                            }
                            if (_0x571606.length > 4 && _0x571606.includes('.')) {
                                world.setDynamicProperty("esploratori:origin", _0x571606);
                            }
                            else {
                                if (_0x571606 !== '') {
                                    _0x3d6ec7.sendMessage("§cInvalid origin provided: example §oplay.dreamsmp.gg");
                                }
                            }
                            world.setDynamicProperty("esploratori:discord_link", _0x586bfa);
                            world.setDynamicProperty("esploratori:startup_notify", _0x1726ed);
                            world.setDynamicProperty("esploratori:output", _0x5b6b65);
                            _0x3d6ec7.sendMessage("§eAll valid settings have been saved.");
                            settings.reload();
                        });
                    }
                    break;
                }
                case "esploratori:status": {
                    switch (_0x298fee.sourceType) {
                        case ScriptEventSource.Entity: {
                            _0x298fee.sourceEntity.sendMessage("status: " + translate[this.#mode]);
                        }
                        case ScriptEventSource.Server: {
                            console.log("(BedrockBridge) Status: " + translate[this.#mode]);
                        }
                    }
                    break;
                }
                case "esploratori:connect": {
                    switch (_0x298fee.sourceType) {
                        case ScriptEventSource.Entity: {
                            if (this.#mode == 1) {
                                _0x298fee.sourceEntity.sendMessage("§cdiscord server already connected.§r");
                            }
                            else {
                                _0x298fee.sourceEntity.sendMessage("connecting...");
                                system.run(async () => {
                                    await this.#login()["catch"](this.#error(10, "login error"));
                                    if (this.#mode == 1) {
                                        _0x298fee.sourceEntity.sendMessage("§ediscord server connected!§r");
                                        console.log("BedrockBridge connected.");
                                    }
                                    else {
                                        _0x298fee.sourceEntity.sendMessage("§cImpossible connecting to the server. Run " + this.prefix + "messages in order to check errors.§r");
                                    }
                                });
                            }
                        }
                        case ScriptEventSource.Server: {
                            if (this.#mode == 1) {
                                console.log("(BedrockBridge) Discord server already connected.");
                            }
                            else {
                                console.log("(BedrockBridge) connecting...");
                                system.run(async () => {
                                    await this.#login()["catch"](this.#error(10, "login error"));
                                    if (this.#mode == 1) {
                                        console.log("BedrockBridge connected.");
                                    }
                                    else {
                                        console.log("(BedrockBridge) Impossible connecting to the server.");
                                    }
                                });
                            }
                        }
                    }
                    break;
                }
            }
        }, {
            'namespaces': ["esploratori"]
        });
        await null;
        world.afterEvents.entityDie.subscribe(async _0x4aaeab => {
            if (!(_0x4aaeab.deadEntity instanceof Player)) {
                return;
            }
            if (_0x4aaeab.damageSource.damagingEntity) {
                var _0x187baa = _0x4aaeab.deadEntity.name + " was killed by " + (_0x4aaeab.damageSource.damagingEntity.name ?? _0x4aaeab.damageSource.damagingEntity.typeId.replace("minecraft:", ''));
            }
            else {
                var _0x187baa = _0x4aaeab.deadEntity.name + " died by " + _0x4aaeab.damageSource.cause;
            }
            const _0x1f77fe = {
                message: _0x187baa
            };
            const {
                message: _0x5c3c0c,
                cancel: _0x625b09
            } = await bridge.events.playerDieLog.emit(_0x1f77fe, _0x4aaeab.deadEntity, _0x4aaeab.damageSource).then(_0x5e0697 => {
                if (!(typeof _0x5e0697.message === "string" && _0x5e0697.message.length >= 1 && _0x5e0697.message.length <= 100)) {
                    _0x5e0697.message = _0x187baa;
                }
                return _0x5e0697;
            });
            if (!_0x625b09) {
                this.#push(['log', ["playerDeath", [_0x4aaeab.deadEntity.name, _0x5c3c0c]]]);
            }
        }, {
            'entityTypes': ["minecraft:player"]
        });
        await null;
        world.afterEvents.entityDie.subscribe(async _0x2be942 => {
            if (_0x2be942.deadEntity.isValid() && _0x2be942.deadEntity.getComponent("minecraft:is_tamed")) {
                if (_0x2be942.damageSource.damagingEntity) {
                    var _0x15d15e = (_0x2be942.deadEntity.nameTag && _0x2be942.deadEntity.nameTag != '' ? _0x2be942.deadEntity.nameTag : _0x2be942.deadEntity.typeId.replace("minecraft:", '')) + " was killed by " + (_0x2be942.damageSource.damagingEntity.name ?? _0x2be942.damageSource.damagingEntity.typeId.replace("minecraft:", ''));
                }
                else {
                    var _0x15d15e = (_0x2be942.deadEntity.nameTag && _0x2be942.deadEntity.nameTag != '' ? _0x2be942.deadEntity.nameTag : _0x2be942.deadEntity.typeId.replace("minecraft:", '')) + " died by " + _0x2be942.damageSource.cause;
                }
                const _0x4f9d36 = {
                    message: _0x15d15e
                };
                const {
                    message: _0x483083,
                    cancel: _0x41c085
                } = await bridge.events.petDieLog.emit(_0x4f9d36, _0x2be942.deadEntity, _0x2be942.damageSource).then(_0x43ccf2 => {
                    if (!(typeof _0x43ccf2.message === "string" && _0x43ccf2.message.length >= 1 && _0x43ccf2.message.length <= 100)) {
                        _0x43ccf2.message = _0x15d15e;
                    }
                    return _0x43ccf2;
                });
                if (!_0x41c085) {
                    this.#push(["log", ['petDeath', [_0x2be942.deadEntity.typeId.replace("minecraft:", ''), _0x483083]]]);
                }
            }
        });
        const _0x524f52 = async _0x4b10c5 => {
            if (_0x4b10c5.message.startsWith(this.prefix)) {
                const [_0x4e8d37, ..._0xbee3d7] = _0x4b10c5.message.slice(1).split("\"").flatMap((_0x1b7fa0, _0x5b835b) => _0x5b835b % 2 == 1 ? _0x1b7fa0.trim() : _0x1b7fa0.trim().split(" "));
                this.#command_manager(_0x4b10c5.sender, _0x4e8d37, _0xbee3d7);
                _0x4b10c5.cancel = true;
            }
            else {
                if (this.#mode <= 1) {
                    const _0xcd4c34 = _0x4b10c5.sender.getDynamicProperty("esp:pfp");
                    const _0xf45b27 = {
                        author: _0x4b10c5.sender.name,
                        message: _0x4b10c5.message
                    };
                    const {
                        author: _0x559410,
                        message: _0x201edb,
                        cancel: _0x4c50ba
                    } = await bridge.events.chatUpStream.emit(_0xf45b27, _0x4b10c5.sender).then(_0x2c7525 => {
                        if (!(typeof _0x2c7525.author === "string" && _0x2c7525.author.length >= 1 && _0x2c7525.author.length <= 100)) {
                            _0x2c7525.author = _0x4b10c5.sender.name;
                        }
                        if (!(typeof _0x2c7525.message === "string" && _0x2c7525.message.length >= 1 && _0x2c7525.message.length <= 1000)) {
                            _0x2c7525.message = _0x4b10c5.message;
                        }
                        return _0x2c7525;
                    });
                    if (!_0x4c50ba) {
                        if (_0xcd4c34) {
                            this.#push(["txt", [_0x559410, _0x201edb, _0xcd4c34]]);
                        }
                        else {
                            this.#push(["txt", [_0x559410, _0x201edb]]);
                        }
                    };
                }
            }
        };
        world.beforeEvents.chatSend.subscribe(async _0xd5bea => {
            if (_0xd5bea.sender.hasTag('MutedBB')) {
                _0xd5bea.cancel = true;
                return;
            }
            await _0x524f52(_0xd5bea);
        });
        world.afterEvents.playerSpawn.subscribe(({
            player: _0x2ee499
        }) => {
            const _0x47b1dd = _0x2ee499.getDynamicProperty("esp:nameTag");
            if (_0x47b1dd) {
                _0x2ee499.nameTag = _0x47b1dd;
            }
        });
        world.afterEvents.playerSpawn.subscribe(_0x129f72 => {
            if (_0x129f72.player.name in this.#banned_list) {
                if (this.#banned_list[_0x129f72.player.name]) {
                    _0x129f72.player.addTag("BannedBB");
                    this.#push(['log', ['banned', _0x129f72.player.name]]);
                }
                else {
                    _0x129f72.player.removeTag("BannedBB");
                    this.#push(['log', ["unbanned", _0x129f72.player.name]]);
                }
                delete this.#banned_list[_0x129f72.player.name];
            }
            if (_0x129f72.player.hasTag("BannedBB")) {
                _0x129f72.player.runCommandAsync("kick " + _0x129f72.player.name + " §lyou are banned from this server");
            }
        });
    }
    #error(_0x4b770d, _0x1b6cb7) {
        return async _0x256902 => {
            const _0x1b1313 = _0x256902.message ? _0x256902.message : _0x256902;
            if (this.logging) {
                world.sendMessage("- Error " + _0x4b770d + ": " + _0x1b6cb7 + "\n" + _0x1b1313 + "\n");
            }
            const _0x4c3aa3 = {
                code: _0x4b770d
            };
            _0x4c3aa3.message = _0x1b1313;
            bridge.events.error.emit(_0x4c3aa3);
        };
    }
    #push(..._0xe16ee2) {
            this.#cache.push(..._0xe16ee2);
        }
        ["getTick"]() {
            return this.#n_tick;
        }
    async #login(_0x395c85 = 0) {
        this.#mode = _0x395c85;
        this.emit("status", translate[0], translate[this.#mode]);
        const _0x38d6ab = new HttpRequest("http://" + this.#serverEndpoint + '/login');
        _0x38d6ab.method = HttpRequestMethod.Get;
        _0x38d6ab.timeout = 60;
        _0x38d6ab.headers = [new HttpHeader("auth", settings.get("authtoken")), new HttpHeader("version", "1.3.10-alpha"), new HttpHeader("startup_notify", settings.get("startup_notify")?.['toString']() ?? '0'), new HttpHeader("output", settings.get("output")?.["toString"]() ?? '0')];
        if (settings.has("origin")) {
            _0x38d6ab.addHeader('origin', settings.get('origin'));
        }
        this.#outgoing = true;
        for (let _0x536c38 = 0; _0x536c38 < 5; _0x536c38++) {
            try {
                const _0x47cbf3 = await http.request(_0x38d6ab);
                if (_0x47cbf3.status >= 200) {
                    let _0x3ad412 = _0x47cbf3.status == 200 ? [
                        ['login', JSON.parse(_0x47cbf3.body)]
                    ] : JSON.parse(_0x47cbf3.body);
                    for (const _0x2d596d of _0x3ad412) {
                        await this.#evalPacket(_0x2d596d)["catch"](this.#error(9, "error while decoding packet" + _0x2d596d[0]));
                    }
                    this.#outgoing = false;
                    return;
                }
            }
            catch (_0xe33ee6) {
                this.#error(3, "failed login. bad server response.")(_0xe33ee6);
                this.cache_message = "Login failed due to connection issues. Try to reconnect by §o" + this.prefix + 'connect';
            }
            await sleep(10 + _0x536c38 * 5);
        }
        this.#outgoing = false;
        this.emit('status', translate[4], this.#mode);
        console.warn("BedrockBridge disconnected.");
        this.#mode = 4;
    }
    async #command_manager(_0x5754e1, _0x3403d5, _0x40f7b5) {
        switch (_0x3403d5) {
            case "help": {
                let _0x5203dd = "\nList of available commands:\n§o" + this.prefix + "help§r - lists all commands for BedrockBridge addon.\n" + '§o' + this.prefix + "connect§r - connect to your discord server.\n" + '§o' + this.prefix + "messages§r - list error messages received from the server.\n" + '§o' + this.prefix + "status - current status of the server.\n" + '§o' + this.prefix + "logging [on/off]§r - enable error logging.\n" + '§o' + this.prefix + "linkdc§r - make your streamed chat from mc look like your discord messages (on discord).\n" + '§o' + this.prefix + "unlink§r - reset your streamed picture and nametag to your xbox account (requires relog).\n" + '§o' + this.prefix + "deaf§r - stop messages from discord from being visualised on your screen.\n" + '§o' + this.prefix + "undeaf§r - resume discord-message show on your screen.\n";
                bridge.bedrockCommands.forEach((_0x16a844, _0x29ef99, _0x5a099b, _0x4857ff) => {
                    if (_0x4857ff.length === 0) {
                        _0x5203dd += '§o' + this.prefix + _0x16a844 + "§r - " + _0x5a099b + "\n";
                    }
                    else {
                        for (const _0x5f217b of _0x4857ff) {
                            if (_0x5754e1.hasTag(_0x5f217b)) {
                                _0x5203dd += '§o' + this.prefix + _0x16a844 + "§r - " + _0x5a099b + "\n";
                                return;
                            }
                        }
                    }
                });
                _0x5203dd += "\n";
                _0x5754e1.sendMessage(_0x5203dd);
                break;
            }
            case "connect": {
                if (this.#mode == 1) {
                    _0x5754e1.sendMessage("§cdiscord server already connected.§r");
                }
                else {
                    _0x5754e1.sendMessage("connecting...");
                    system.run(async () => {
                        await this.#login()["catch"](this.#error(10, "login error"));
                        console.log("BedrockBridge connected.");
                        if (this.#mode == 1) {
                            _0x5754e1.sendMessage("§ediscord server connected!§r");
                        }
                        else {
                            _0x5754e1.sendMessage("§cImpossible connecting to the server. Run " + this.prefix + "messages in order to check errors.§r");
                        }
                    });
                }
                break;
            }
            case "status": {
                _0x5754e1.sendMessage("status: " + translate[this.#mode]);
                break;
            }
            case "logging": {
                if (_0x40f7b5[0] == 'on') {
                    _0x5754e1.sendMessage("§eerror logging enabled§r");
                    this.logging = true;
                }
                else if (_0x40f7b5[0] == "off") {
                    _0x5754e1.sendMessage("§eerror logging disabled");
                    this.logging = false;
                }
                break;
            }
            case "messages": {
                if (this.cache_message) {
                    _0x5754e1.sendMessage(this.cache_message);
                }
                else {
                    _0x5754e1.sendMessage("§cno message from server found.§r");
                }
                break;
            }
            case "linkdc": {
                try {
                    if (settings.get("discord_link")) {
                        if (!this.#checkCooldown(_0x5754e1)) {
                            this.#push(["set", ['dcu', _0x5754e1.name]]);
                            _0x5754e1.sendMessage("§eIn order to switch your appearance from minecraft-style to discord-style go to your discord server and run /claimdc using the following token as argument:");
                            this.#setCooldown(_0x5754e1, 300);
                        }
                        else {
                            _0x5754e1.sendMessage("§cCommand is in cooldown, please wait.§r");
                        }
                    }
                    else {
                        _0x5754e1.sendMessage("§cdiscord-link is not allowed on this server.§r");
                    }
                }
                catch (_0x52a8bb) {
                    world.sendMessage("error" + _0x52a8bb);
                }
                break;
            }
            case 'unlink': {
                try {
                    if (_0x5754e1.getDynamicProperty('esp:pfp')) {
                        _0x5754e1.setDynamicProperty("esp:pfp", undefined);
                        if (this.#online_players[_0x5754e1.name]) {
                            delete this.#online_players[_0x5754e1.name];
                        }
                    }
                    if (_0x5754e1.getDynamicProperty("esp:nameTagDc")) {
                        _0x5754e1.setDynamicProperty("esp:nameTagDc", undefined);
                    }
                    _0x5754e1.sendMessage("§eYour profile picture and nametag for chat stream have been reset. When you relog they will be set to default: xbox picture and mc nametag.§r");
                }
                catch (_0x3672b8) {
                    _0x5754e1.sendMessage("error");
                    _0x5754e1.sendMessage(_0x3672b8.message);
                }
                break;
            }
            case "test": {
                console.log(JSON.stringify(await getStats(_0x5754e1)));
                break;
            }
            case 'deaf': {
                if (!_0x5754e1.hasTag("esploratori:self_deaf")) {
                    _0x5754e1.sendMessage("§eWe will stop showing you messages from discord. If you want to resume visualising them simply run §o" + this.prefix + "undeaf.");
                    system.run(() => {
                        _0x5754e1.addTag("esploratori:self_deaf");
                    });
                }
                else {
                    _0x5754e1.sendMessage("§cYou are already deafened.");
                }
                break;
            }
            case 'undeaf': {
                if (_0x5754e1.hasTag("esploratori:self_deaf")) {
                    _0x5754e1.sendMessage("§eWe will resume showing you messages from discord!");
                    system.run(() => {
                        _0x5754e1.removeTag("esploratori:self_deaf");
                    });
                }
                else {
                    _0x5754e1.sendMessage("§cYou are already not deafen.");
                }
                break;
            }
            default: {
                if (bridge.bedrockCommands.isAllowed(_0x3403d5, _0x5754e1)) {
                    await bridge.bedrockCommands.runCommand(_0x3403d5, _0x5754e1, ..._0x40f7b5.map(_0x29e6c4 => new commandArgument(_0x29e6c4)));
                }
                else {
                    _0x5754e1.sendMessage("§cThere is no such command or you are not allowed to run it. Run " + this.prefix + "help for the full list of commands.§r");
                }
            }
        }
    }
    async #evalPacket(_0x2ca2fe) {
        const [_0x2be269, _0x4394ea] = _0x2ca2fe;
        switch (_0x2be269) {
            case "login": {
                this.#TICK_MAX = _0x4394ea.TICK_MAX;
                this.#token = _0x4394ea.token;
                this.#mode = _0x4394ea.mode;
                this.logging = _0x4394ea.logging;
                this.#max_cache = _0x4394ea.max_cache;
                this.#server_request = new_req(_0x4394ea.address, _0x4394ea.token);
                this.#push(["set", ["playerCount", this.#n_online_players]]);
                this.emit('login');
                break;
            }
            case 'txt': {
                var [_0x55a14b, _0x17d721, _0x41588b] = _0x4394ea;
                if (this.additions.has("discord_roles")) {
                    const _0x2974e6 = this.additions.get("discord_roles");
                    if (_0x2974e6) {
                        _0x41588b = _0x41588b.map(_0xd90969 => _0x2974e6[_0xd90969] ?? _0xd90969);
                    }
                    else {
                        const _0x1c75f7 = {
                            discord_roles: true
                        };
                        this.#push(['set', ["add", _0x1c75f7]]);
                    }
                }
                const _0x309b7e = {
                    author: _0x55a14b,
                    message: _0x17d721,
                    roles: _0x41588b
                };
                const {
                    author: _0x23def2,
                    message: _0x4370e9,
                    cancel: _0x50b0bb
                } = await bridge.events.chatDownStream.emit(_0x309b7e).then(_0x2a89e7 => {
                    if (!(typeof _0x2a89e7.author === 'string' && _0x2a89e7.author.length > 0 && _0x2a89e7.author.length < 50)) {
                        _0x2a89e7.author = _0x55a14b;
                    }
                    if (!(typeof _0x2a89e7.message === 'string' && _0x2a89e7.message.length > 0 && _0x2a89e7.message.length < 100)) {
                        _0x2a89e7.message = _0x17d721;
                    }
                    return _0x2a89e7;
                });
                if (!_0x50b0bb) {
                    world.sendMessage("§9<" + _0x23def2 + "> " + _0x4370e9 + '§r');
                }
                break;
            }
            case 'ann': {
                world.sendMessage(_0x4394ea);
                break;
            }
            case "set": {
                const [_0x4d847a, ..._0x48cd4b] = _0x4394ea;
                await this.#set_exe[_0x4d847a](..._0x48cd4b);
                break;
            }
            case "com": {
                const [_0x4e4525, _0x52a500, _0x3d60ab] = _0x4394ea;
                if (!bridge.discordCommands.isAllowed(_0x52a500.split(" ")[0]) && !_0x3d60ab) {
                    this.#push(['com', [_0x4e4525, "This command is disabled on this server.", false]]);
                    return;
                }
                await overworld.runCommandAsync(_0x52a500).then(async _0x4fae7b => {
                    this.#push(["com", [_0x4e4525, _0x4fae7b.successCount, true]]);
                }, _0x5a7fa8 => {
                    this.#push(["com", [_0x4e4525, _0x5a7fa8.message ? _0x5a7fa8.message : _0x5a7fa8, false]]);
                })["catch"](this.#error(13, "parsing command response object error"));
                break;
            }
            case "ext": {
                const [_0xfb5b4c, _0x576eac] = _0x4394ea;
                await this.#eval_ext[_0xfb5b4c](..._0x576eac);
                break;
            }
        }
    }
    #eval_ext = {
        'ban': async (token, [username, do_ban]) => {
            getPlayer(username).then(async player => {
                if (player) {
                    if (do_ban) {
                        player.addTag("BannedBB");
                        await player.runCommandAsync("kick " + username + " §lyou have been banned from this server");
                        this.#push(["com", [token, username + " was banned from the server", true]]);
                    }
                }
                else {
                    this.#banned_list[username] = do_ban;
                    this.#push(["com", [token, "Player not found online.\n*Note: " + username + " will be added to temp list. But if the server is restarted before they try to join ban/unban will be ineffective.*", true]]);
                }
            })["catch"](err => {
                this.#push(["com", [token, err.message ? err.message : err, false]]);
                this.#error(14, "error while searching player")(err);
            });
        },
        'mut': (token, [username, do_mute, time]) => {
            getPlayer(username).then(async player => {
                if (player) {
                    if (do_mute) {
                        player.addTag("MutedBB");
                        this.#push(['com', [token, player.name + " was muted.", true]]);
                        if (time && time > 0) {
                            system.runTimeout(() => {
                                if (player.isValid()) {
                                    player.sendMessage("§oYou have been unmuted.");
                                    player.removeTag("MutedBB");
                                }
                            }, Math.floor(time * 1200));
                        }
                    }
                    else if (player.hasTag("MutedBB")) {
                        player.removeTag("MutedBB");
                        this.#push(['com', [token, player.name + " was unmuted.", true]]);
                    }
                    else {
                        this.#push(['com', [token, player.name + " is not muted.", false]]);
                    }
                }
                else {
                    this.#push(['com', [token, username + " not found online.", false]]);
                }
            })['catch'](err => {
                this.#push(['com', [token, err.message ? err.message : err, false]]);
                this.#error(15, "error while searching player")(err);
            });
        },
        'tag': (token, [username, nametag]) => {
            const _0x17805f = {
                "jmbpN": function(x, y) {
                    return x + y;
                },
                "vbeIO": 'poHEt',
                IczKb: 'YTkWB',
                "GvALY": function(x, y) {
                    return x == y;
                },
                "oyoOh": "ihovG"
            };
            _0x17805f.uwHZN = "pbCKU";
            _0x17805f.sGyGr = "esp:nameTag";
            _0x17805f.eQgPL = "com";
            _0x17805f.FOnvb = "error while searching player";
            getPlayer(username).then(async player => {
                if (player) {
                    if (username == nametag) {
                        if ("ihovG" !== _0x17805f.uwHZN) {
                            player.setDynamicProperty(_0x17805f.sGyGr, undefined);
                        }
                        else {
                            return this.get(_0x2129f1) ?? this.get(_0x23307b + ':' + _0x3ea39b);
                        }
                    }
                    else {
                        player.setDynamicProperty(_0x17805f.sGyGr, nametag);
                    }
                    player.nameTag = nametag;
                    this.#push([_0x17805f.eQgPL, [token, username + " was renamed to " + nametag, true]]);
                }
                else {
                    this.#push([_0x17805f.eQgPL, [token, username + " not found online.", false]]);
                }
            })["catch"](err => {
                this.#push(["com", [token, err.message ? err.message : err, false]]);
                this.#error(16, _0x17805f.FOnvb)(err);
            });
        },
        'loc': (token, username) => {
            const _0x3210f5 = {
                "PPGPM": function(x, y) {
                    return x === y;
                },
                "AhIsH": function(x, y) {
                    return x !== y;
                },
                "VGwxw": "sBSmK",
                "nBHRK": 'com',
                "vyErw": function(x, y) {
                    return x === y;
                },
                kxyXZ: "DEnyu",
                wWMDD: "OZloy"
            };
            _0x3210f5.pvgEQ = "§cProvided token is too short.";
            _0x3210f5.sWRMl = "NFDUT";
            _0x3210f5.tTEJB = "rMgLQ";
            _0x3210f5.FXgUP = "error while searching player";
            getPlayer(username).then(async player => {
                if (player) {
                    const {
                        x: x,
                        y: y,
                        z: z
                    } = player.location;
                    this.#push(['com', [token, [Math.floor(x), Math.floor(y), Math.floor(z), player.dimension.id.slice(10)], true]]);
                }
                else {
                    this.#push(['com', [token, username + " not found online.", false]]);
                }
            })['catch'](err => {
                const _0x13fceb = {
                    Igpwj: _0x3210f5.pvgEQ
                };
                if (_0x3210f5.sWRMl !== _0x3210f5.tTEJB) {
                    this.#push(['com', [token, err.message ? err.message : err, false]]);
                    this.#error(17, _0x3210f5.FXgUP)(err);
                }
                else {
                    _0x4d6aef.sendMessage(_0x13fceb.Igpwj);
                }
            });
        },
        'inv': (token, username) => {
            getPlayer(username).then(async player => {
                if (player) {
                    await getInventory(player).then(inventory => {
                        this.#push(['com', [token, inventory, true]]);
                    });
                }
                else {
                    this.#push(['com', [token, username + " not found online.", false]]);
                }
            })["catch"](err => {
                this.#push(['com', [token, "It wasn't possible retreiving player's inventory.", false]]);
                this.#error(19, "get inventory error")(err);
            });
        },
        'sta': (token, username) => {
            getPlayer(username).then(async player => {
                if (player) {
                    await getStats(player).then(stats => {
                        this.#push(["com", [token, stats, true]]);
                    });
                }
                else {
                    this.#push(['com', [token, username + " not found online.", false]]);
                }
            })["catch"](err => {
                this.#push(["com", [token, "It wasn't possible retreiving player's stats.", false]]);
                this.#error(19, "get stats error")(err);
            });
        },
        'pxc': (token, [distance, enabled]) => {
            const _0x2b4920 = {
                'taBTL': function(x, y) {
                    return x === y;
                }
            };
            _0x2b4920.XNHSM = 'NGRDx';
            _0x2b4920.SiKIV = 'XllJt';
            _0x2b4920.FqnIh = 'com';
            this.proximity_enabled = enabled;
            if (distance) {
                if (_0x2b4920.XNHSM === _0x2b4920.SiKIV) {
                    _0x412c75.error("[Bedrock-Bridge] Couldn't find token in \"secrets.json\". Please make sure that \"/config\" folder is properly setup.");
                }
                else {
                    this.proximity_distance = distance;
                    this.#push(["com", [token, "new distance set to " + distance, true]]);
                }
            }
            else {
                this.#push([_0x2b4920.FqnIh, [token, "proximity set to " + enabled, true]]);
            }
        },
        'kil': (token, username) => {
            getPlayer(username).then(player => {
                if (player) {
                    player.kill();
                    this.#push(["com", [token, "you killed " + player.name, true]]);
                }
                else {
                    this.#push(["com", [token, username + " not found online.", false]]);
                }
            })["catch"](err => {
                this.#push(["com", [token, err.message ? err.message : err, false]]);
                this.#error(19, "error while searching player")(err);
            });
        },
        'lst': token => {
            const player_list = {};
            let statusok = false;
            for (const mode in GameMode) {
                const _0x329897 = {
                    'gameMode': mode
                };
                for (const player of world.getPlayers(_0x329897)) {
                    player_list[player.name] = mode;
                    statusok = true;
                }
            }
            this.#push(["com", [token, player_list, statusok]]);
        }
    };
    #set_exe = [async TICK_MAX => {
        this.#TICK_MAX = TICK_MAX;
    }, async address => {
        this.#server_request = new_req(address, this.#token);
    }, async token => {
        const _0x3a1e73 = {
            jKiQk: "Content-Type"
        };
        _0x3a1e73.utKlm = "application/json";
        _0x3a1e73.Ntjyz = 'auth';
        this.#token = token;
        this.#server_request.headers = [new HttpHeader("Content-Type", _0x3a1e73.utKlm), new HttpHeader(_0x3a1e73.Ntjyz, token)];
    }, async status => {
        this.logging = status;
    }, async status => {
        const _0x367cb5 = {
            nsedy: function(x, y) {
                return x > y;
            }
        };
        _0x367cb5.jUlBB = "status";
        if (status == 2) {
            if (this.#n_online_players > 0) {
                this.#login();
                return;
            }
        }
        this.emit(_0x367cb5.jUlBB, translate[status], this.#mode);
        this.#mode = status;
    }, async message => {
        this.cache_message = message;
    }, async (timeout = 0, endpoint) => {
        if (endpoint) {
            this.#serverEndpoint = endpoint;
        }
        this.#mode = 3;
        await sleep(timeout);
        await this.#login();
    }, async ([nametag, url]) => {
        const _0x4db1dd = {
            name: nametag
        };
        for (const player of world.getPlayers(_0x4db1dd)) {
            system.run(() => {
                player.setDynamicProperty('esp:pfp', url);
            });
        }
    }, async ([nametag, dcname]) => {
        const _0x2fc94d = {
            name: nametag
        };
        for (const player of world.getPlayers(_0x2fc94d)) {
            player.setDynamicProperty("esp:nameTagDc", dcname);
        }
    }, async roles => {
        const _0x2131f3 = {
            'GLYTs': "discord_roles"
        };
        _0x2131f3.oOQHv = "addition error";
        _0x2131f3.tNMSw = "received roles packet without request.";
        if (this.additions.has("discord_roles")) {
            this.additions.set("discord_roles", roles);
        }
        else {
            this.#error(8, _0x2131f3.oOQHv)(_0x2131f3.tNMSw);
        }
    }];
    async #cache_check() {
        if (this.#cache.length > this.#max_cache) {
            this.#error(7, "cache over limit: resizing")('');
            this.#cache.slice(this.#cache.length - this.#max_cache);
        }
    }
    #cycle = async () => {
        let _0x44b0ed = 0;
        system.runInterval(() => {
            if (_0x44b0ed >= this.#TICK_MAX) {
                if (!this.#outgoing) {
                    this.#onTick()["catch"](this.#error(11, "on_tick error"));
                    _0x44b0ed = 0;
                }
            }
            else {
                _0x44b0ed += 5;
            }
        }, 5);
    };
    async #onTick() {
        await this.#cache_check()["catch"](this.#error(20, "cache check error"));
        switch (this.#mode) {
            case 1: {
                const _0x43b944 = this.#cache;
                this.#cache = [];
                try {
                    this.#server_request.body = JSON.stringify(_0x43b944);
                }
                catch (_0x3dab77) {
                    this.#server_request.body = [
                        ["error", [1, _0x3dab77]]
                    ];
                }
                this.#outgoing = true;
                for (let _0x8ae112 = 0; _0x8ae112 < 10; _0x8ae112++) {
                    try {
                        const _0xbffa95 = await http.request(this.#server_request);
                        if (_0xbffa95.status >= 200) {
                            const _0x2f92b4 = JSON.parse(_0xbffa95.body);
                            if (_0xbffa95.status >= 300) {
                                this.#cache = _0x43b944.concat(this.#cache);
                            }
                            for (const _0x47a2ce of _0x2f92b4) {
                                await this.#evalPacket(_0x47a2ce)["catch"](this.#error(9, "error while decoding packet " + _0x47a2ce[0]));
                            }
                            this.#outgoing = false;
                            return;
                        }
                    }
                    catch (_0x8fe68c) {
                        this.#error(22, "failed request")(_0x8fe68c);
                        this.cache_message = _0x8fe68c;
                    }
                    this.#cache = _0x43b944.concat(this.#cache);
                    await sleep(_0x8ae112 ** 3 + 5);
                }
                this.#outgoing = false;
                this.emit("status", translate[3], this.#mode);
                console.warn("BedrockBridge disconnected.");
                this.#mode = 4;
                break;
            }
            case 4: {
                if (Math.random() < 0.1 && !this.#outgoing) {
                    this.#login(4)['catch'](_0x4e75f3 => {});
                }
            }
        }
    }
    async ["emit"](_0x1557c6, ..._0x338f8b) {
        if (_0x1557c6 in this.#callback_list) {
            try {
                this.#callback_list[_0x1557c6](..._0x338f8b);
            }
            catch (_0x1f95eb) {
                this.#error(1, "error while emitting " + _0x1557c6 + " event")(_0x1f95eb);
            }
        }
    }
    async ['on'](_0x65e71a, _0x2b0b57) {
        this.#callback_list[_0x65e71a] = _0x2b0b57;
    }
    #setCooldown(_0x34b6ad, _0x4dca1b = 100) {
        this.#command_cooldown[_0x34b6ad.id] = system.runTimeout(() => {
            delete this.#command_cooldown[_0x34b6ad.id];
        }, 100);
    }
    #checkCooldown(_0x5b54e0) {
        return this.#command_cooldown[_0x5b54e0.id];
    }
    #command_cooldown = {};
    #outgoing = false;
    #n_online_players = 0;
    #n_tick = 0;
    #mode = 0;
    #max_cache = 100;
    #token = '';
    #cache = [];
    #TICK_MAX = 80;
    #callback_list = {};
    #server_request;
    ['logging'] = false;
    #serverEndpoint = "localhost:60";
    #online_players = {};
    #banned_list = {};
    ["proximity_distance"] = 0;
    ["proximity_enabled"] = false;
}
_0x1d1291.ServerVariables.prototype.getPrefixed = function(_0x532257, _0x4c3c3a) {
    return this.get(_0x4c3c3a) ?? this.get(_0x532257 + ':' + _0x4c3c3a);
};
_0x1d1291.ServerSecrets.prototype.getPrefixed = function(_0x461038, _0x48fc7e) {
    return this.get(_0x48fc7e) ?? this.get(_0x461038 + ':' + _0x48fc7e);
};

function _0x37bbb6(_0x3eee0a, _0x1be93d, _0x2e1b79, _0x307e35) {
    return _0x3eff(_0x307e35 - 0x272, _0x3eee0a);
}
Array.prototype.includesAll = function(..._0x317eff) {
    for (const _0x1c8cfb of _0x317eff) {
        if (!this.includes(_0x1c8cfb)) {
            return false;
        }
    }
    return true;
};
Array.prototype.includesPrefixedAll = function(_0x111899, ..._0x39a1af) {
    for (const _0x4d1d7f of _0x39a1af) {
        if (!this.includes(_0x4d1d7f) && !this.includes(_0x111899 + ':' + _0x4d1d7f)) {
            return false;
        }
    }
    return true;
};
String.prototype.readBase64At = function(_0x57bccc) {
    if (_0x57bccc >= 0) {
        return "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(this.charAt(_0x57bccc));
    }
    else {
        return "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(this.charAt(_0x57bccc + this.length));
    }
};
const settings_names = ["prefix", "discord_link", "startup_notify"];
const all_settings_names = settings_names.concat(settings_names, ['origin', "output"]);
class BridgeSettings extends Map {
    static #data;
    constructor() {
        if (BridgeSettings.#data) {
            throw new Error("Cannot create more than one instance of this class");
        }
        else {
            super();
        }
    }
    static["getSettingsSync"]() {
        if (BridgeSettings.#data) {
            return BridgeSettings.#data;
        }
        else {
            BridgeSettings.#data = new BridgeSettings();
            return BridgeSettings.#data;
        }
    }
    static async ["getSettings"]() {
        if (!BridgeSettings.#data) {
            BridgeSettings.#data = new BridgeSettings();
            await BridgeSettings.#data.setup();
        }
        return BridgeSettings.#data;
    }
    async ['setup']() {
        return new Promise(_0x1768f2 => {
            const _0x23952e = {
                UKnFA: "§cdiscord server already connected.§r",
                tqmIa: "§cCommand is in cooldown, please wait.§r"
            };
            _0x23952e.nnXUC = "prefix";
            system.run(() => {
                if (_0x1d1291.variables.names.includesPrefixedAll("esploratori", ...settings_names)) {
                    for (const _0x23ebc7 of all_settings_names) {
                        if (_0x1d1291.variables.names.includesPrefixedAll("esploratori", _0x23ebc7)) {
                            this.set(_0x23ebc7, _0x1d1291.variables.getPrefixed("esploratori", _0x23ebc7));
                        }
                    }
                    if (_0x1d1291.secrets.names.includesPrefixedAll("esploratori", 'authtoken')) {
                        this.set('authtoken', _0x1d1291.secrets.getPrefixed("esploratori", 'authtoken'));
                    }
                    else {
                        console.error("[Bedrock-Bridge] Couldn't find token in \"secrets.json\". Please make sure that \"/config\" folder is properly setup.");
                    }
                    if (!this.has("output")) {
                        this.set("output", 0);
                    }
                    this.ingame = false;
                }
                else {
                    for (const _0x335fd1 of all_settings_names) {
                        try {
                            const _0x269e92 = world.getDynamicProperty("esploratori:" + _0x335fd1);
                            if (_0x269e92 !== undefined) {
                                this.set(_0x335fd1, _0x269e92);
                            }
                        }
                        catch (_0x28f512) {}
                    }
                    try {
                        const _0x262917 = world.getDynamicProperty("esploratori:authtoken");
                        if (_0x262917) {
                            this.set('authtoken', this.#decode(_0x262917));
                        }
                        else {
                            console.error("[Bedrock-Bridge] Missing discord token. Please complete setup in order to use this addon.");
                        }
                    }
                    catch (_0x2f2a46) {}
                    this.ingame = true;
                }
                if (!this.has("output")) {
                    this.set("output", 0);
                }
                _0x1768f2(this.ingame);
            });
        });
    }
    async ['reload']() {
        this.clear();
        await this.setup();
    }
    get["ready"]() {
            return this.has('authtoken');
        }
        ["setToken"](_0x4e1102) {
            world.setDynamicProperty("esploratori:authtoken", this.#encode(_0x4e1102));
        }
    #encode(_0x42e037) {
        if (_0x42e037.length < 5) {
            throw "[BedrockBridge] provided token is too short. Please make sure you added the right token.";
        }
        const _0xffba98 = Math.floor(Math.random() * 64);
        let _0x5cabe8 = _0x42e037.readBase64At(0) ^ _0xffba98;
        const _0xea438e = [_0xffba98, _0x5cabe8];
        for (let _0x23ca2f = 1; _0x23ca2f < _0x42e037.length; _0x23ca2f++) {
            _0x5cabe8 ^= _0x42e037.readBase64At(_0x23ca2f);
            _0xea438e.push(_0x5cabe8);
        }
        let _0x19f9fb = 0;
        _0xea438e.forEach(_0xa30caa => _0x19f9fb = (_0x19f9fb + _0xa30caa) % 64);
        return _0xea438e.map(_0x5a0270 => "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(_0x5a0270 ^ _0x19f9fb)).reverse().join('');
    }
    #decode(_0x3b7db5) {
            if (_0x3b7db5.length < 5) {
                throw "[BedrockBridge] provided token is too short. Please make sure you added the right token.";
            }
            const _0x4c5e53 = [];
            for (let _0xa38128 = 0; _0xa38128 < _0x3b7db5.length - 1; _0xa38128++) {
                _0x4c5e53.push(_0x3b7db5.readBase64At(_0xa38128) ^ _0x3b7db5.readBase64At(_0xa38128 + 1));
            }
            return _0x4c5e53.map(_0x57295e => "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(_0x57295e)).reverse().join('');
        }
        ["test"](_0x3d3652) {
            const _0x4ce064 = this.#encode(_0x3d3652);
            return [_0x4ce064, this.#decode(_0x4ce064)];
        }
}
class MainBridgeMenuForm {
    #form;
    static #description = "Here you can setup and customise BedrockBridge. If this is the first time you use this addon make sure to add the discord token.\n\nYou can require a new token from your discord server by running §o/new-token§r.\n\n";
    constructor(_0x44dc13 = true, _0x1542da = true, _0x36bbb1 = 0, _0x22f817) {
        this.#form = new ModalFormData().title("BedrockBridge - Settings").textField(MainBridgeMenuForm.#description + "Command prefix", "e.g. !").textField("Discord token (if you have already added it in the past you can ignore this)", "§oe.g. 69B7WFVegZZZCqU").textField("Origin [optional]", _0x22f817 ?? "e.g. play.mydomain.gg").dropdown("Discord output mode", ["default", "legacy", "compact"], _0x36bbb1).toggle("Discord link", _0x44dc13).toggle("Startup notifications", _0x1542da);
    }
    static async ["show"](_0x1f3f2f) {
        const _0x5b612f = await BridgeSettings.getSettings();
        const _0x166447 = new MainBridgeMenuForm(_0x5b612f.get("discord_link"), _0x5b612f.get("startup_notify"), _0x5b612f.get("output"), _0x5b612f.get("origin"));
        return _0x166447.#form.show(_0x1f3f2f);
    }
}
const setup_menu = new ModalFormData();
setup_menu.title("BedrockBridge - Settings");
setup_menu.textField("Here you can setup and customise BedrockBridge. If this is the first time you use this addon make sure to add the discord token.\n\nYou can require a new token from your discord server by running §o/new-token§r.\n\nCommand prefix", "e.g. !");
setup_menu.textField("Discord token (if you have already added it in the past you can ignore this)", "§oe.g. 69B7WFVegZZZCqU");
setup_menu.textField("Origin [optional]", "e.g. play.mydomain.gg");
setup_menu.dropdown("Discord output mode", ['default', "legacy", "compact"], 0);
setup_menu.toggle("Discord link", true);
setup_menu.toggle("Startup notifications", false);
const settings = new BridgeSettings();
async function main() {
    const _0x52de9c = {
        "BlJqi": function(_0x3246da, _0x290a4d) {
            return _0x3246da + _0x290a4d;
        },
        "LJUED": function(_0x1ee65e, _0xf7c81e) {
            return _0x1ee65e + _0xf7c81e;
        }
    };
    _0x52de9c.iDmEC = function(_0x4e71d8, _0x238092) {
        return _0x4e71d8 + _0x238092;
    };
    _0x52de9c.hwsfK = "§r - ";
    _0x52de9c.THjYE = function(_0x4a1b18, _0x208e3f) {
        return _0x4a1b18 !== _0x208e3f;
    };
    _0x52de9c.sZXmU = 'bKnIQ';
    _0x52de9c.iOsMW = "prefix";
    _0x52de9c.GORET = function(_0x1fbcc1, _0x4bc2e5) {
        return _0x1fbcc1 + _0x4bc2e5;
    };
    _0x52de9c.nwTaO = "[BedrckBridge][Plugins] error while importing plugins.\n";
    await settings.setup();
    Object.defineProperty(bridge.bedrockCommands, _0x52de9c.iOsMW, {
        'get': () => {
            if (_0x52de9c.THjYE("bKnIQ", _0x52de9c.sZXmU)) {
                if (_0x1bda70.hasTag(_0xb8ae9b)) {
                    _0x2aa06c += _0x52de9c.iDmEC('§o' + this.prefix, _0x2d2666) + _0x52de9c.hwsfK + _0x10fcf2 + "\n";
                    return;
                }
            }
            else {
                return settings.get(_0x52de9c.iOsMW);
            }
        }
    });
    await import("./bridgePlugins/index")['catch'](_0x5ef529 => {
        console.error(_0x52de9c.GORET(_0x52de9c.nwTaO, _0x5ef529));
    });
}
main();
export {
    bridge
};
